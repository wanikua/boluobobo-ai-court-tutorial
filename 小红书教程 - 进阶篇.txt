🚀 朝廷进阶玩法：5 个神器让你效率翻倍

进阶篇 | 老手必看 | 5500 字 | 效率提升 500%
适用人群：已搭建好朝廷，想进一步提升效率
预计耗时：30-40 分钟
最终效果：远程编程不断线 + 代码自动备份 + 奏折自动写 + 定时任务 + Discord 协作

━━━━━━━━━━━━━━━━━━━━━━━━

📖 目录

1. tmux - 远程编程神器
2. GitHub 自动化 - 代码自动备份
3. Notion 数据库 - 朝廷自动写奏折
4. cron - 定时任务自动执行
5. Discord - 朝廷总部设置

━━━━━━━━━━━━━━━━━━━━━━━━

一、tmux - 远程编程神器

🎯 痛点：为什么需要 tmux？

你有没有遇到过这些崩溃瞬间：

😭 SSH 写代码写到一半，网络断了，所有进度没了
😭 跑个长任务，关掉终端就没了，得重新来
😭 同时开好几个 SSH 窗口，切来切去眼花
😭 在网吧/咖啡厅用公共 WiFi，随时可能断连

tmux 就是来解决这些问题的！

💡 tmux 是什么？

简单说就是一个终端复用器，让你：
✅ SSH 断线后，重新连上去，所有程序还在运行
✅ 一个窗口 split 成多个面板，同时干多件事
✅ 后台跑任务，关掉终端也不影响
✅ 多人共享同一个终端会话（协作神器）

⏱️ 学习成本：10 分钟上手，受益终身
📍 配图 1：tmux 多面板示意图（上中下三个面板分别跑不同命令）

━━━━━━━━━━━━━━━━━━━━━━━━

📦 安装 tmux（复制粘贴）

# Ubuntu/Debian
sudo apt update
sudo apt install tmux -y

# 验证安装
tmux -V
# 应显示 tmux 3.x

⏱️ 耗时：1 分钟
📍 成功标志：输出版本号就对了！✅

━━━━━━━━━━━━━━━━━━━━━━━━

🔧 基础用法：5 个命令走天下

1️⃣ 创建新会话

# 创建名为 coding 的会话
tmux new -s coding

# 或者不指定名字（自动生成数字编号）
tmux new

📍 配图 2：新建 tmux 会话后的界面，底部绿色状态栏

2️⃣ 退出会话（但保持运行）

# 按 Ctrl+B，然后按 D
# 或者
tmux detach

💡 重点：退出后会话还在后台运行！程序不会停！

3️⃣ 重新连接会话

# 列出所有会话
tmux ls

# 连接到 coding 会话
tmux attach -t coding

# 如果有多个会话，连接最后一个
tmux attach

📍 配图 3：tmux ls 输出，显示多个会话列表

4️⃣ 分屏操作（超实用！）

快捷键 | 功能
Ctrl+B 然后 % | 左右分屏
Ctrl+B 然后 " | 上下分屏
Ctrl+B 然后 方向键 | 切换面板
Ctrl+B 然后 X | 关闭当前面板
Ctrl+B 然后 Z | 最大化/还原当前面板

💡 使用场景：
- 左边面板写代码，右边面板看日志
- 上边面板跑服务，下边面板测试 API
- 同时监控多个服务器的状态

📍 配图 4：tmux 四分屏界面，每个面板跑不同命令

5️⃣ 会话管理

# 重命名当前会话
tmux rename-session -t 旧名字 新名字

# 杀死会话
tmux kill-session -t coding

# 杀死所有会话
tmux kill-server

━━━━━━━━━━━━━━━━━━━━━━━━

⚔️ 实战场景：SSH 断线也不怕

场景 1：跑长任务（模型训练/数据处理）

# 1. 创建会话
tmux new -s training

# 2. 启动训练脚本
python train.py --epochs 100

# 3. 按 Ctrl+B 然后 D 退出（任务继续跑）

# 4. 第二天重新连接
tmux attach -t training
# 训练还在继续！进度没丢！

📍 配图 5：重新连接后看到训练仍在进行的截图

场景 2：远程开发 + 实时测试

# 1. 创建会话
tmux new -s dev

# 2. 左右分屏
# 按 Ctrl+B 然后 %

# 3. 左边面板：编辑代码
nano app.py

# 4. 右边面板：运行测试
python test.py

# 5. 随时切换面板修改 + 测试

场景 3：多服务器监控

# 1. 创建会话
tmux new -s monitor

# 2. 分成 4 个面板（2x2）
# Ctrl+B %  然后 Ctrl+B "  然后 Ctrl+B "

# 3. 每个面板连接不同服务器
# 面板 1: ssh server1 → htop
# 面板 2: ssh server2 → htop
# 面板 3: ssh server3 → htop
# 面板 4: 本地看日志

# 4. 一个屏幕监控所有服务器！

📍 配图 6：四面板监控不同服务器的示意图

━━━━━━━━━━━━━━━━━━━━━━━━

💡 小贴士

1. 配置 tmux 让它更好用

# 创建配置文件
cat > ~/.tmux.conf << 'EOF'
# 设置前缀键为 Ctrl+A（比 Ctrl+B 顺手）
set -g prefix C-a
unbind C-b
bind C-a send-prefix

# 鼠标支持（可以点选面板）
set -g mouse on

# 历史滚动行数
set -g history-limit 10000

# 状态栏颜色
set -g status-bg blue
set -g status-fg white
EOF

# 重新加载配置
tmux source-file ~/.tmux.conf

2. 常用命令速查表

命令 | 作用
tmux new -s 名字 | 创建新会话
tmux ls | 列出会话
tmux attach -t 名字 | 连接会话
tmux detach | 退出会话
Ctrl+B D | 快速退出
Ctrl+B % | 左右分屏
Ctrl+B " | 上下分屏
Ctrl+B 方向键 | 切换面板
Ctrl+B Z | 最大化面板
tmux kill-session -t 名字 | 删除会话

3. 给会话起有意义的名字
- coding - 写代码
- deploy - 部署相关
- monitor - 监控
- data - 数据处理

━━━━━━━━━━━━━━━━━━━━━━━━

二、GitHub 自动化 - 代码自动备份

🎯 痛点：为什么需要 GitHub 自动化？

你是不是经常遇到：

😭 代码写完忘提交了，服务器崩了全没了
😭 手动 git add/commit/push 太麻烦，懒得弄
😭 想自动备份朝廷配置，但每次都忘
😭 团队协作时，忘记创建 Issue 追踪任务

GitHub skill 就是来拯救你的！

💡 GitHub skill 能做什么？

- ✅ 自动提交代码到仓库
- ✅ 自动创建 Issue 追踪任务
- ✅ 自动管理 Pull Request
- ✅ 定时备份朝廷配置到 GitHub
- ✅ 代码变更自动通知

⏱️ 配置时间：10 分钟
📍 配图 7：GitHub skill 工作流程图（朝廷 → GitHub → 自动备份）

━━━━━━━━━━━━━━━━━━━━━━━━

📦 配置 GitHub Skill

1️⃣ 生成 GitHub Personal Access Token

# 1. 访问 https://github.com/settings/tokens
# 2. 点击 "Generate new token (classic)"
# 3. 填写：
#    - Note: clawdbot-server
#    - Expiration: No expiration
#    - Scopes: 勾选 repo, workflow
# 4. 点击 Generate，复制 Token（格式：ghp_xxxxx）

🔴 重要：Token 只显示一次！复制后妥善保存！

📍 配图 8：GitHub Token 生成页面，圈出需要勾选的权限

2️⃣ 配置环境变量

# 添加 GitHub Token
echo 'export GITHUB_TOKEN="ghp_你的 Token"' >> ~/.bashrc

# 配置 Git 用户信息
git config --global user.name "Clawdbot 朝廷"
git config --global user.email "clawdbot@your-email.com"

# 生效
source ~/.bashrc

3️⃣ 创建备份仓库

# 在 GitHub 上创建新仓库（私有）
# 名字：clawdbot-backup
# 不要初始化 README

# 然后在服务器上克隆
cd ~/clawd
git init
git remote add origin git@github.com:你的用户名/clawdbot-backup.git

━━━━━━━━━━━━━━━━━━━━━━━━

🔧 基础用法：5 个核心命令

1️⃣ 用 GitHub skill 提交代码

# 让朝廷自动提交代码
在 Discord 里 @对应部门 说"把当前目录的改动提交到 GitHub，commit message 写'自动备份配置'"

2️⃣ 创建 Issue

# 创建新 Issue
在 Discord 里 @对应部门 说"在 GitHub 仓库创建一个 Issue，标题是'优化日志系统'，描述写'需要改进日志格式和存储方式'"

3️⃣ 查看仓库状态

# 查看最近的提交
在 Discord 里 @对应部门 说"查看最近 5 次提交记录"

# 查看未解决的 Issue
在 Discord 里 @对应部门 说"列出所有未关闭的 Issue"

4️⃣ 管理 Pull Request

# 创建 PR
在 Discord 里 @对应部门 说"为 dev 分支创建 PR 到 main 分支，标题是'新增用户模块'"

# 合并 PR
在 Discord 里 @对应部门 说"合并 PR #42 到 main 分支"

5️⃣ 自动备份脚本

# 创建自动备份脚本
cat > ~/clawd/auto-backup.sh << 'EOF'
#!/bin/bash

cd ~/clawd

# 添加所有改动
git add .

# 提交
git commit -m "自动备份 $(date '+%Y-%m-%d %H:%M:%S')"

# 推送
git push origin main

echo "✅ 备份完成！$(date)"
EOF

# 赋予执行权限
chmod +x ~/clawd/auto-backup.sh

━━━━━━━━━━━━━━━━━━━━━━━━

⚔️ 实战案例：让朝廷自动备份代码

案例 1：每天凌晨自动备份

# 1. 编辑 crontab
crontab -e

# 2. 添加这行（每天凌晨 3 点备份）
0 3 * * * cd ~/clawd && ./auto-backup.sh >> ~/clawd/backup.log 2>&1

# 3. 保存退出

💡 效果：每天凌晨 3 点，朝廷自动把当天所有改动备份到 GitHub！

📍 配图 9：crontab 配置截图 + GitHub 提交历史截图

案例 2：重要操作前自动备份

# 创建部署前备份函数
cat >> ~/.bashrc << 'EOF'

# 部署前自动备份
deploy-backup() {
    echo "🔄 开始备份..."
    cd ~/clawd
    git add .
    git commit -m "部署前备份 $(date '+%Y-%m-%d %H:%M')"
    git push origin main
    echo "✅ 备份完成！开始部署..."
}
EOF

# 使用
deploy-backup
# 然后执行你的部署命令

案例 3：朝廷配置变更自动追踪

# 创建监控脚本
cat > ~/clawd/watch-config.sh << 'EOF'
#!/bin/bash

# 监控配置文件变化
FILES=("clawdbot.json" "SOUL.md" "IDENTITY.md" "USER.md")

for file in "${FILES[@]}"; do
    if git diff --quiet -- "$file"; then
        echo "$file 无变化"
    else
        echo "⚠️ $file 有变化！"
        git add "$file"
        git commit -m "配置变更：$file $(date '+%H:%M')"
        git push origin main
    fi
done
EOF

chmod +x ~/clawd/watch-config.sh

━━━━━━━━━━━━━━━━━━━━━━━━

💡 小贴士

1. GitHub Actions 自动 CI/CD

# .github/workflows/auto-deploy.yml
name: 自动部署

on:
  push:
    branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: 部署到服务器
        run: |
          echo "自动部署中..."
          # 添加你的部署命令

2. 私有仓库更安全
- 朝廷配置可能包含敏感信息
- 建议用私有仓库（Private Repository）
- 免费账号也有无限私有仓库

3. 备份频率建议
- 开发中：每次重要改动后
- 稳定期：每天凌晨自动备份
- 部署前：必须手动备份一次

4. 多仓库管理

# 朝廷代码仓库
~/clawd → github.com/you/clawdbot-backup

# 项目代码仓库
~/projects → github.com/you/projects

# 配置文件仓库
~/.clawdbot → github.com/you/clawdbot-config

━━━━━━━━━━━━━━━━━━━━━━━━

三、Notion 数据库 - 朝廷自动写奏折

🎯 痛点：为什么需要 Notion 自动化？

你是不是经常遇到：

😭 每天/每周要写日报周报，烦死了
😭 项目进展分散在各处，汇总太麻烦
😭 想记录朝廷干了什么，但懒得整理
😭 老板/客户要看进度，临时抱佛脚

Notion skill 让朝廷自动写奏折！

💡 Notion skill 能做什么？

- ✅ 自动记录每日工作（起居注）
- ✅ 自动生成周报（朔望录）
- ✅ 自动追踪项目进展（列传）
- ✅ 自动管理财务数据（食货表）
- ✅ 自动整理技术文档（天工志）

⏱️ 配置时间：15 分钟
📍 配图 10：Notion 史记式架构总览图

━━━━━━━━━━━━━━━━━━━━━━━━

📦 配置 Notion Skill

1️⃣ 获取 Notion Integration Token

# 1. 访问 https://www.notion.so/my-integrations
# 2. 点击 "+ New integration"
# 3. 填写：
#    - Name: Clawdbot 朝廷
#    - Workspace: 选择你的工作区
# 4. 点击 Submit，复制 Token（格式：secret_xxxxx）

📍 配图 11：Notion Integration 创建页面

2️⃣ 连接数据库

# 1. 打开你的 Notion 页面
# 2. 点击右上角 ... → Connect connections
# 3. 选择刚创建的 Clawdbot 朝廷
# 4. 确认授权

3️⃣ 配置环境变量

# 添加 Notion Token
mkdir -p ~/.config/notion && echo ""secret_你的 Token"" > ~/.config/notion/api_key

# 配置数据库 ID（⚠️ 必须替换为你自己的数据库 ID！）
# 如何获取：打开 Notion 数据库页面，看 URL 最后一串字符
# 例如：notion.so/30f90cde52d481daa6a0f9a03c21046d
#                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ 这就是 ID
echo 'export NOTION_DAILY_DB="你的日报数据库 ID"' >> ~/.bashrc
echo 'export NOTION_WEEKLY_DB="你的周报数据库 ID"' >> ~/.bashrc

# 生效
source ~/.bashrc

📍 配图 12：Notion 数据库 ID 获取方法（页面 URL 中的 ID）

━━━━━━━━━━━━━━━━━━━━━━━━

🔧 基础用法：5 个核心场景

1️⃣ 自动记录日报（起居注）

# 让礼部自动写日报
在 Discord 里 @对应部门 说"生成今天的日报，记录朝廷完成的工作"

# 或者直接调用 Notion skill
在 Discord 里 @司礼监 说"在 Notion 日报数据库创建一条记录，标题是今天的日期，内容包含今天完成的任务"

2️⃣ 自动生成周报（朔望录）

# 让礼部汇总本周工作
在 Discord 里 @对应部门 说"生成本周周报，汇总所有完成的任务和进展"

# 写入 Notion
在 Discord 里 @司礼监 说"在 Notion 周报数据库创建记录，标题是'第 X 周周报'，内容包含本周工作总结"

3️⃣ 项目进展追踪（列传）

# 更新项目状态
在 Discord 里 @司礼监 说"更新 Notion 项目数据库，pindoudou 项目状态改为'进行中'，进度 65%"

# 添加项目日志
在 Discord 里 @司礼监 说"在 pindoudou 项目页面添加今日进展：完成了用户登录模块"

4️⃣ 财务数据记录（食货表）

# 记录 API 花费
在 Discord 里 @司礼监 说"在 Notion 财务数据库添加记录：日期今天，类别'API 费用'，金额 2.5 美元，备注'Claude 调用'"

# 月度汇总
在 Discord 里 @司礼监 说"汇总本月所有 API 花费，按服务分类统计"

5️⃣ 技术文档整理（天工志）

# 创建技术文档
在 Discord 里 @对应部门 说"在 Notion 技术数据库创建文档，标题是'Clawdbot 部署指南'，内容包含完整的安装步骤"

━━━━━━━━━━━━━━━━━━━━━━━━

⚔️ 实战案例：朝廷自动写奏折

Clawdbot 内置 cron 定时任务功能，不需要写 bash 脚本。
直接在 clawdbot.json 里配置，朝廷会自动执行。

案例 1：每日自动日报

在 clawdbot.json 的 cron 字段中添加：

"cron": [
  {
    "id": "daily-report",
    "schedule": "0 14 * * *",
    "text": "生成今日日报：汇总今天完成的任务、遇到的问题、明天的计划。用简洁中文分点列出，同步写入 Notion 日报数据库。",
    "agent": "司礼监"
  }
]

说明：
- schedule 是标准 cron 表达式，"0 14 * * *" = 每天 UTC 14:00（北京时间 22:00）
- text 是你要朝廷执行的指令，用自然语言写
- agent 指定哪个 agent 来执行

案例 2：每周自动周报

{
  "id": "weekly-report",
  "schedule": "0 12 * * 0",
  "text": "生成本周周报：汇总本周各项目进展、关键数据、遇到的挑战和解决方案、下周计划。同步写入 Notion 周报数据库。",
  "agent": "司礼监"
}

案例 3：项目进展自动同步

{
  "id": "project-sync",
  "schedule": "0 10 * * 1,4",
  "text": "检查所有 GitHub 仓库的最近提交和未关闭 Issue，更新 Notion 项目数据库的状态和进度。",
  "agent": "兵部"
}

完整 cron 配置示例（放在 clawdbot.json 里）：

"cron": [
  {
    "id": "daily-report",
    "schedule": "0 14 * * *",
    "text": "生成今日日报，写入 Notion",
    "agent": "司礼监"
  },
  {
    "id": "weekly-report",
    "schedule": "0 12 * * 0",
    "text": "生成本周周报，写入 Notion",
    "agent": "司礼监"
  },
  {
    "id": "project-sync",
    "schedule": "0 10 * * 1,4",
    "text": "同步项目进展到 Notion",
    "agent": "兵部"
  }
]

💡 关键区别：Clawdbot 的 cron 不是 Linux crontab！
不需要写 bash 脚本，直接用自然语言告诉朝廷要做什么。
Clawdbot 会启动一个 agent session 来执行你的指令。

📍 配图 13：clawdbot.json 中 cron 配置的截图

━━━━━━━━━━━━━━━━━━━━━━━━

💡 小贴士

1. Notion 数据库字段设计建议

数据库 | 核心字段 | 说明
起居注（日报） | 日期、工作内容、问题、明日计划 | 每日快速记录
朔望录（周报） | 周次、开始日期、结束日期、总结、数据 | 每周汇总
列传（项目） | 项目名、状态、进度、负责人、最后更新 | 项目追踪
食货表（财务） | 日期、类别、金额、备注、凭证 | 财务记录
天工志（技术） | 标题、分类、标签、内容、最后更新 | 技术文档

2. Notion 模板加速输入

# 创建日报模板
# 在 Notion 中创建模板按钮，预设好格式：
# - ✅ 完成的工作
# - ⚠️ 遇到的问题
# - 📋 明日计划
# - 💡 思考/灵感

3. 自动化程度分级

级别 | 自动化程度 | 实现方式
L1 | 手动生成 | 让朝廷写内容，手动复制到 Notion
L2 | 半自动 | 脚本生成内容 + 手动确认
L3 | 全自动 | 定时任务 + Notion API 自动写入

4. 数据安全建议
- 敏感数据不要放在 Notion（用加密字段）
- 定期导出备份（Notion → 本地）
- 设置合适的分享权限

5. 与其他工具联动
- GitHub Issues → Notion 项目追踪
- Google Calendar → Notion 日程
- Slack/Discord → Notion 会议纪要

━━━━━━━━━━━━━━━━━━━━━━━━

四、cron - 定时任务自动执行

🎯 痛点：为什么需要 cron？

你是不是经常遇到：

😭 每天都要手动执行同样的任务，烦死了
😭 想定时备份数据，但总是忘记
😭 需要凌晨跑批处理，但不想熬夜
😭 团队协作时，任务执行时间不统一

cron 就是来解放你的！

💡 cron 是什么？

简单说就是一个定时任务调度器，让你：
✅ 每天/每周/每月自动执行任务
✅ 凌晨自动跑批处理，起床看结果
✅ 定时备份数据，再也不怕丢
✅ 团队任务统一时间执行

⏱️ 学习成本：5 分钟上手，受益终身
📍 配图 14：cron 工作流程图（时间到 → 自动执行 → 通知结果）

━━━━━━━━━━━━━━━━━━━━━━━━

📦 cron 基础语法

1️⃣ crontab 格式

# 分 时 日 月 周  命令
# * * * * * command to execute
# │ │ │ │ │
# │ │ │ │ └─ 星期 (0-7, 0 和 7 都是周日)
# │ │ │ └─── 月份 (1-12)
# │ │ └───── 日期 (1-31)
# │ └─────── 小时 (0-23)
# └───────── 分钟 (0-59)

2️⃣ 常用时间表达式

表达式 | 含义 | 示例
* * * * * | 每分钟 | 每分钟执行一次
0 * * * * | 每小时整点 | 每小时执行一次
0 9 * * * | 每天早上 9 点 | 日报生成
0 9 * * 1 | 每周一早上 9 点 | 周报生成
0 0 1 * * | 每月 1 号凌晨 | 月报生成
*/5 * * * * | 每 5 分钟 | 监控任务
0 */2 * * * | 每 2 小时 | 数据同步

📍 配图 15：cron 时间表达式速查表

━━━━━━━━━━━━━━━━━━━━━━━━

🔧 基础用法：5 个核心命令

1️⃣ 编辑 crontab

# 编辑当前用户的 crontab
crontab -e

# 查看当前 crontab
crontab -l

# 删除所有 crontab
crontab -r

2️⃣ 添加定时任务

# 编辑 crontab
crontab -e

# 添加任务（每天凌晨 3 点备份）
0 3 * * * cd ~/clawd && ./backup.sh >> ~/clawd/backup.log 2>&1

# 保存退出（vi: :wq, nano: Ctrl+X → Y → Enter）

3️⃣ 查看 cron 日志

# Ubuntu/Debian
grep CRON /var/log/syslog

# CentOS/RHEL
grep CRON /var/log/cron

# 实时查看
tail -f /var/log/syslog | grep CRON

4️⃣ 测试 cron 表达式

# 使用 croniter 测试（需要安装）
pip install croniter

# Python 测试脚本
python3 << 'EOF'
from croniter import croniter
from datetime import datetime

cron = croniter("0 9 * * 1", datetime.now())
print("下次执行时间:", cron.get_next(datetime))
EOF

5️⃣ 环境变量配置

# 在 crontab 顶部设置环境变量
SHELL=/bin/bash
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
MAILTO=your-email@example.com

# 然后是你的任务
0 9 * * * /path/to/command

━━━━━━━━━━━━━━━━━━━━━━━━

⚔️ 实战场景：朝廷自动化任务

💡 Clawdbot 有内置 cron 功能，直接在 clawdbot.json 里配置，
用自然语言写指令，不需要写 bash 脚本！

场景 1：每日自动日报

{
  "id": "daily-report",
  "schedule": "0 14 * * *",
  "text": "生成今日日报，写入 Notion 日报数据库",
  "agent": "司礼监"
}

💡 schedule 用标准 cron 表达式，"0 14 * * *" = UTC 14:00 = 北京 22:00

场景 2：每周自动备份代码

{
  "id": "weekly-backup",
  "schedule": "0 9 * * 5",
  "text": "把 ~/clawd 目录的改动提交并 push 到 GitHub，commit message 写'周备份'",
  "agent": "兵部"
}

场景 3：服务器健康检查

{
  "id": "health-check",
  "schedule": "0 */6 * * *",
  "text": "检查服务器 CPU、内存、磁盘使用率，如果有异常立即通知",
  "agent": "司礼监"
}

场景 4：每月财务汇总

{
  "id": "monthly-finance",
  "schedule": "0 12 1 * *",
  "text": "汇总本月所有 API 花费和服务器成本，按类别统计，写入 Notion 财务数据库",
  "agent": "户部"
}

场景 5：每天早上发工作计划

{
  "id": "morning-plan",
  "schedule": "0 1 * * *",
  "text": "在 Discord 日报频道发送今日工作计划提醒",
  "agent": "司礼监"
}

⚠️ 注意：这是 Clawdbot 内置 cron，不是 Linux crontab！
所有配置写在 clawdbot.json 的 "cron" 数组里。

━━━━━━━━━━━━━━━━━━━━━━━━

💡 小贴士

1. 调试 cron 任务

# 方法 1：手动执行脚本，确保能正常运行
./your-script.sh

# 方法 2：添加详细日志
*/5 * * * * /path/to/script.sh >> /tmp/cron-test.log 2>&1

# 方法 3：检查 cron 服务状态
sudo systemctl status cron  # Ubuntu/Debian
sudo systemctl status crond # CentOS/RHEL

2. 常见陷阱

问题 | 原因 | 解决方案
任务不执行 | PATH 不对 | 在 crontab 顶部设置 PATH
中文乱码 | 语言环境 | 添加 LANG=zh_CN.UTF-8
权限不足 | 用户权限 | 用 sudo 或切换到正确用户
脚本找不到 | 相对路径 | 用绝对路径 cd /full/path && ./script

3. 最佳实践

# 推荐的 crontab 格式
SHELL=/bin/bash
PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
LANG=zh_CN.UTF-8
MAILTO=your-email@example.com

# 任务示例
# 每日任务
0 9 * * * cd ~/clawd && ./daily-task.sh >> ~/logs/daily.log 2>&1

# 每周任务
0 10 * * 1 cd ~/clawd && ./weekly-task.sh >> ~/logs/weekly.log 2>&1

# 每月任务
0 11 1 * * cd ~/clawd && ./monthly-task.sh >> ~/logs/monthly.log 2>&1

4. 安全建议
- 不要在 crontab 中明文写密码
- 敏感信息用环境变量或配置文件
- 定期清理旧的日志文件
- 监控 cron 执行失败的情况

⏱️ 耗时：5 分钟配置，永久受益
📍 配图 16：crontab 配置示例截图

━━━━━━━━━━━━━━━━━━━━━━━━

五、Discord - 朝廷总部设置

🎯 痛点：为什么用 Discord 管理朝廷？

你是不是经常遇到：

😭 微信群消息太乱，重要信息被刷屏
😭 想分类管理不同项目，但微信群做不到
😭 权限混乱，谁都能看所有消息
😭 想集成机器人自动通知，微信不支持
😭 团队协作时，找不到历史讨论记录

Discord 就是来拯救你的！

💡 Discord 优势：

- ✅ 多频道分类：不同项目/部门独立频道，互不干扰
- ✅ 权限管理：谁能看什么、谁能说什么，精细控制
- ✅ 机器人集成：Clawdbot 随时待命，自动执行命令
- ✅ 历史记录：永久保存，随时搜索查找
- ✅ 多端同步：电脑/手机/网页，消息实时同步
- ✅ 免费无限：消息数量、频道数量都没有限制

⏱️ 配置时间：15 分钟
📍 配图 17：Discord 服务器架构图（菠萝王朝示例）

━━━━━━━━━━━━━━━━━━━━━━━━

📦 Discord 服务器创建

1️⃣ 注册 Discord 账号

# 1. 访问 https://discord.com/register
# 2. 填写：
#    - 邮箱（建议用 Gmail/Outlook）
#    - 用户名（建议用朝廷相关名字）
#    - 密码
#    - 出生日期
# 3. 验证邮箱
# 4. 完成！

📍 配图 18：Discord 注册页面截图

2️⃣ 创建服务器

# 1. 点击左侧服务器列表的 "+" 号
# 2. 选择 "创建我的服务器"
# 3. 填写：
#    - 服务器名称：菠萝王朝（或你喜欢的名字）
#    - 服务器图标：上传朝廷 logo
# 4. 点击创建

📍 配图 19：创建服务器页面，圈出填写区域

3️⃣ 基础频道设置

# 默认会创建：
# - #general（综合讨论）
# - #announcements（公告）

# 建议先删除或重命名：
# 右键频道 → 编辑频道 → 改名/删除

━━━━━━━━━━━━━━━━━━━━━━━━

🔧 Clawdbot 接入 Discord

1️⃣ 创建 Discord Bot

# 1. 访问 Discord Developer Portal
#    https://discord.com/developers/applications

# 2. 点击 "New Application"
# 3. 填写名字：Clawdbot 朝廷
# 4. 点击 Create

# 5. 进入应用页面，左侧菜单选 "Bot"
# 6. 点击 "Add Bot" → "Yes, do it!"

# 7. 重置 Token（重要！）：
#    - 点击 "Reset Token"
#    - 复制 Token（格式类似：MTIzNDU2Nzg5MDEyMzQ1Njc4OQ.xxxxxx.xxxxx）
#    - 🔴 妥善保存！只显示一次！

📍 配图 20：Discord Developer Portal 创建 Bot 页面

2️⃣ 配置 Bot 权限

# 在 Bot 页面，找到 "Privileged Gateway Intents"
# 勾选：
# ✅ MESSAGE CONTENT INTENT（读取消息内容）
# ✅ SERVER MEMBERS INTENT（读取成员信息）
# ✅ PRESENCE INTENT（读取在线状态）

# 点击 Save Changes

📍 配图 21：Bot 权限配置页面，圈出需要勾选的选项

3️⃣ 配置 clawdbot.json

# 编辑朝廷配置文件
nano ~/clawd/clawdbot.json

# 添加 Discord 配置：
{
  "discord": {
    "token": "你的 Bot Token",
    "serverId": "你的服务器 ID",
    "channels": {
      "daily": "日报频道 ID",
      "weekly": "周报频道 ID",
      "monthly": "月报频道 ID",
      "commands": "命令频道 ID",
      "logs": "日志频道 ID"
    }
  }
}

# 保存退出（Ctrl+X → Y → Enter）

💡 获取服务器/频道 ID 方法：
1. Discord 设置 → 高级 → 开启开发者模式
2. 右键服务器/频道 → 复制 ID

📍 配图 22：开发者模式开启 + 复制 ID 示意图

4️⃣ 邀请 Bot 进服务器（关键步骤！）

# 1. 在 Developer Portal，左侧选 "OAuth2" → "URL Generator"

# 2. 勾选 scopes（必需）：
#    ✅ bot
#    ✅ applications.commands

# 3. 勾选 Bot Permissions（建议权限）：
#    ✅ Send Messages          - 发送消息
#    ✅ Manage Channels         - 管理频道
#    ✅ Manage Roles            - 管理角色
#    ✅ Read Message History    - 读取历史消息
#    ✅ Embed Links             - 发送富文本
#    ✅ Attach Files            - 发送文件

# 4. 复制生成的 URL（在页面底部）
#    格式类似：https://discord.com/api/oauth2/authorize?client_id=xxx&...

# 5. 在浏览器打开这个 URL
#    - 选择你要安装的服务器（你需要是管理员）
#    - 点击"授权"
#    - 完成人机验证（如果有）

# 6. 验证 Bot 已加入
#    - 打开你的服务器
#    - 左侧服务器列表底部应该能看到 Bot 头像
#    - 或在服务器设置 → 成员 中看到 Bot

# 6. 完成！Bot 已加入服务器！

📍 配图 23：OAuth2 URL Generator 配置页面

⚠️ 常见问题：
Q: 找不到我的服务器？
A: 确保你是服务器管理员，且 Bot 权限足够

Q: 授权失败？
A: 检查服务器是否已达到成员上限，或联系 Discord 支持

Q: Bot 加入了但不说话？
A: 检查 clawdbot.json 配置是否正确，Gateway 是否启动

━━━━━━━━━━━━━━━━━━━━━━━━

🏛️ 频道架构设置（参考菠萝王朝）

1️⃣ 分类结构

🏯 菠萝王朝
├── 📜 本纪（奏报频道）
│   ├── 📅 起居注（日报）
│   ├── 📊 朔望录（周报）
│   └── 🌙 编年纪（月报）
├── 🏢 六部（部门频道）
│   ├── ⚔️ 兵部（技术/开发）
│   ├── 💰 户部（财务/运营）
│   ├── 🎋 礼部（文档/内容）
│   ├── 👥 吏部（人事/招聘）
│   ├── ⚖️ 刑部（安全/审计）
│   └── 📚 学部（学习/研究）
├── 🔧 工部（工具频道）
│   ├── 🤖 命令中心
│   ├── 📝 日志记录
│   └── 🔔 通知提醒
└── 💬 闲聊（非正式）
    ├── ☕ 茶水间
    └── 💡 灵感交流

📍 配图 24：完整的频道架构截图

2️⃣ 创建分类和频道

# 创建分类（右键服务器 → 创建分类）
# 分类 1: 📜 本纪
# 分类 2: 🏢 六部
# 分类 3: 🔧 工部
# 分类 4: 💬 闲聊

# 在每个分类下创建频道（右键分类 → 创建频道）
# 文本频道类型，不需要语音频道

3️⃣ 频道权限设置

# 以兵部频道为例：
# 1. 右键兵部频道 → 编辑频道 → 权限

# 2. 添加角色权限：
# @所有人：查看频道 ✅  发送消息 ❌
# @兵部成员：查看频道 ✅  发送消息 ✅
# @尚书（管理员）：完全控制 ✅

# 3. 这样只有兵部成员能在兵部频道发言！

📍 配图 25：频道权限配置页面

━━━━━━━━━━━━━━━━━━━━━━━━

⚔️ 实战案例

案例 1：在 Discord 发命令，朝廷执行

# 在命令中心频道发送：
@司礼监 生成今天的日报

# 朝廷会自动：
# 1. 识别命令
# 2. 执行任务
# 3. 在日报频道发送结果

# 示例对话：
你：@司礼监 查看兵部今日任务
朝廷：📋 兵部今日任务：
      1. ✅ 完成用户登录模块
      2. ✅ 修复支付 bug
      3. ⏳ 进行中：API 性能优化（80%）

📍 配图 26：Discord 中发送命令 + 朝廷回复的截图

案例 2：自动汇报到指定频道

# 配置自动汇报（在 clawdbot.json 中设置）
{
  "discord": {
    "autoReport": {
      "daily": {
        "channel": "日报频道 ID",
        "time": "18:00",
        "timezone": "Asia/Shanghai"
      },
      "weekly": {
        "channel": "周报频道 ID",
        "time": "17:00",
        "day": "Friday"
      }
    }
  }
}

# 效果：
# - 每天 18:00 自动在日报频道发送日报
# - 每周五 17:00 自动在周报频道发送周报

📍 配图 27：自动日报在 Discord 频道的展示效果

案例 3：多人协作管理

# 场景：3 人团队管理朝廷

# 1. 创建角色：
# @尚书（管理员）- 完全权限
# @侍郎（核心成员）- 大部分权限
# @主事（普通成员）- 基础权限

# 2. 分配角色：
# 右键成员 → 角色 → 分配对应角色

# 3. 频道权限：
# - 管理频道：只有@尚书能看
# - 部门频道：对应部门成员能看
# - 日报频道：所有人都能看

# 4. 协作流程：
# @主事：在兵部频道汇报进展
# @侍郎：审核并汇总
# @尚书：在日报频道发布最终报告

📍 配图 28：Discord 角色管理页面

━━━━━━━━━━━━━━━━━━━━━━━━

💡 小贴士

1️⃣ 权限设置技巧

角色 | 建议权限 | 适用人群
@尚书 | 管理员权限 | 老板/创始人
@侍郎 | 高级成员权限 | 核心团队成员
@主事 | 普通成员权限 | 一般成员
@观察员 | 只读权限 | 投资人/顾问
@机器人 | 自动化权限 | Clawdbot 等机器人

💡 权限原则：最小权限原则，只给必要的权限

2️⃣ 常用命令速查

# 在 Discord 中可以用的命令（需要配置）：

# 日报相关
!daily              # 生成今日日报
!daily yesterday    # 生成昨日报

# 周报相关
!weekly             # 生成本周周报
!weekly last        # 生成上周周报

# 任务管理
!tasks              # 查看当前任务
!tasks add xxx      # 添加任务
!tasks complete 1   # 完成任务 1

# 项目管理
!projects           # 查看项目列表
!project pindoudou  # 查看特定项目状态

# 系统命令
!status             # 查看朝廷状态
!help               # 查看帮助

3️⃣ 频道分类技巧

# 技巧 1：用 emoji 区分频道类型
# 📅 日报  📊 周报  🌙 月报
# ⚔️ 兵部  💰 户部  🎋 礼部

# 技巧 2：用数字排序
# 01-起居注  02-朔望录  03-编年纪

# 技巧 3：用符号标记重要性
# 🔴 紧急  🟡 进行中  🟢 已完成

# 技巧 4：频道描述写清楚用途
# 右键频道 → 编辑频道 → 添加描述

4️⃣ 通知设置

# 避免消息轰炸：
# 1. 右键服务器 → 通知设置
# 2. 选择 "仅@提及"
# 3. 重要频道单独设置 "所有消息"

# 移动端设置：
# 设置 → 通知 → 自定义服务器通知

5️⃣ 集成其他工具

# GitHub 集成：
# 1. 在 GitHub 仓库设置 → Webhooks
# 2. 添加 Discord Webhook URL
# 3. 选择触发事件（Push/PR/Issue）

# Google Calendar 集成：
# 使用 Zapier 或 IFTTT
# Calendar 事件 → Discord 通知

# 监控告警集成：
# 服务器监控 → Webhook → Discord 告警频道

📍 配图 29：Discord Webhook 配置页面

━━━━━━━━━━━━━━━━━━━━━━━━

🎉 进阶完成！

现在你掌握了朝廷进阶的全部 5 个神器：
✅ tmux：SSH 断线不怕，多面板高效开发
✅ GitHub 自动化：代码自动备份，变更自动追踪
✅ Notion 数据库：奏折自动写，数据自动汇总
✅ cron：定时任务自动执行，解放双手
✅ Discord：朝廷总部，多人协作管理

效率提升：
📈 远程开发稳定性：+100%
📈 代码安全性：+100%
📈 汇报效率：+300%
📈 任务自动化：+200%
📈 团队协作效率：+150%

━━━━━━━━━━━━━━━━━━━━━━━━

━━━━━━━━━━━━━━━━━━━━━━━━

六、Prompt 技巧 - 让朝廷更懂你

🎯 为什么需要学习 Prompt？

同样的问题，不同的问法，结果天差地别：

❌ 差："帮我写个网站"
✅ 好："用 Next.js + Tailwind CSS 写一个个人博客网站首页，包含导航栏、英雄区、文章列表、页脚，响应式设计"

❌ 差："分析这个数据"
✅ 好："分析附件中的 Excel 数据，找出销售额最高的 3 个产品类别，计算同比增长率，用表格形式呈现"

━━━━━━━━━━━━━━━━━━━━━━━━

📖 Prompt 万能公式

【角色】+【任务】+【背景】+【要求】+【格式】

示例：

你是兵部尚书（角色），帮我写一个 Python 脚本（任务），用于批量处理 CSV 文件（背景），要求支持多进程、错误重试、日志记录（要求），输出代码加注释，并说明使用方法（格式）。

━━━━━━━━━━━━━━━━━━━━━━━━

🔧 各部门专用 Prompt 模板

1️⃣ 兵部（技术/代码）

模板：
你是兵部尚书，专精软件工程和系统架构。请用【语言/框架】实现【功能】，要求：
- 【性能要求】
- 【安全要求】
- 【代码规范】
输出：完整代码 + 使用说明 + 测试方法

示例：
你是兵部尚书，专精软件工程和系统架构。请用 Python 写一个网页爬虫，要求：
- 支持并发请求，每秒 10 次
- 自动重试失败请求，最多 3 次
- 遵守 robots.txt，设置 User-Agent
- 数据保存到 SQLite 数据库
输出：完整代码 + 使用说明 + 测试方法

━━━━━━━━━━━━━━━━━━━━━━━━

2️⃣ 户部（财务/数据）

模板：
你是户部尚书，专精财务分析和电商运营。请分析【数据类型】，重点关注：
- 【核心指标 1】
- 【核心指标 2】
- 【异常检测】
输出：数据表格 + 关键发现 + 改进建议

示例：
你是户部尚书，专精财务分析和电商运营。请分析本月 API 使用数据，重点关注：
- 各部门调用次数和成本分布
- 日均/峰值调用时间
- 异常高额调用检测
输出：数据表格 + 关键发现 + 成本优化建议

━━━━━━━━━━━━━━━━━━━━━━━━

3️⃣ 礼部（内容/营销）

模板：
你是礼部尚书，专精品牌营销和社交媒体。请为【产品/服务】撰写【内容类型】，目标受众是【人群】，发布在【平台】，要求：
- 【风格调性】
- 【字数限制】
- 【核心卖点】
- 【行动号召】
输出：完整文案 + 标签建议

示例：
你是礼部尚书，专精品牌营销和社交媒体。请为 AI 朝廷工具撰写小红书文案，目标受众是 25-35 岁程序员，发布在小红书，要求：
- 风格活泼，用 emoji
- 正文 800-1000 字
- 核心卖点：省钱、高效、私有化
- 引导评论"教程"领取资料
输出：完整文案 + 15 个标签建议

━━━━━━━━━━━━━━━━━━━━━━━━

4️⃣ 吏部（项目/管理）

模板：
你是吏部尚书，专精项目管理和创业孵化。请为【项目名称】制定【计划类型】，包括：
- 【时间节点】
- 【关键里程碑】
- 【风险评估】
- 【资源需求】
输出：项目计划表 + 执行建议

示例：
你是吏部尚书，专精项目管理和创业孵化。请为 pindoudou 小程序制定上线计划，包括：
- 4 周时间线
- 每周关键里程碑
- 技术/运营风险评估
- 人力和预算需求
输出：项目计划表 + 执行建议

━━━━━━━━━━━━━━━━━━━━━━━━

5️⃣ 刑部（法务/合规）

模板：
你是刑部尚书，专精法务合规和知识产权。请审查【文档/合同】，重点关注：
- 【合规领域】
- 【风险条款】
- 【缺失内容】
输出：风险清单 + 修改建议 + 参考法规

示例：
你是刑部尚书，专精法务合规和知识产权。请审查这份用户隐私政策，重点关注：
- GDPR 合规性
- 数据收集条款风险
- 用户权利保障是否完整
输出：风险清单 + 修改建议 + 参考法规

━━━━━━━━━━━━━━━━━━━━━━━━

6️⃣ 工部（运维/DevOps）

模板：
你是工部尚书，专精 DevOps 和服务器运维。请为【服务/应用】设计【部署方案】，要求：
- 【可用性要求】
- 【扩展性要求】
- 【监控告警】
- 【备份策略】
输出：架构图 + 部署步骤 + 运维手册

示例：
你是工部尚书，专精 DevOps 和服务器运维。请为 Clawdbot 设计高可用部署方案，要求：
- 99.9% 可用性
- 支持水平扩展
- CPU/内存/磁盘监控告警
- 每日自动备份配置
输出：架构图 + 部署步骤 + 运维手册

━━━━━━━━━━━━━━━━━━━━━━━━

💡 高级技巧

1️⃣ 分步拆解复杂任务

❌ 差："帮我搭建一个电商平台"
✅ 好：
第 1 步：设计数据库 schema（用户、商品、订单）
第 2 步：搭建用户认证系统（注册、登录、JWT）
第 3 步：实现商品管理 CRUD
第 4 步：实现购物车和订单流程
第 5 步：集成支付接口

2️⃣ 提供示例参考

"参考这个风格写文案：【粘贴示例】"
"按照这个代码结构写：【粘贴示例】"

3️⃣ 指定输出格式

"用表格形式呈现"
"用 Markdown 代码块"
"分点列出，每点不超过 50 字"
"先给结论，再展开说明"

4️⃣ 设定约束条件

"不超过 500 字"
"只用标准库，不用第三方依赖"
"预算控制在$100/月以内"
"兼容 Python 3.8+"

5️⃣ 追问迭代

第 1 轮："生成方案"
第 2 轮："方案 A 和方案 B 各有什么优缺点？"
第 3 轮："基于方案 B，优化成本部分"
第 4 轮："生成具体实施步骤"

━━━━━━━━━━━━━━━━━━━━━━━━

⚠️ 常见错误

1. 问题太模糊
❌ "帮我优化代码"
✅ "优化这个函数的性能，当前执行时间 2 秒，目标 200ms 以内"

2. 缺少背景信息
❌ "写个 API"
✅ "写个 RESTful API，用 FastAPI，用户管理功能，JWT 认证，PostgreSQL 数据库"

3. 一次问太多
❌ "帮我搭建网站、写文案、做 SEO、投广告"
✅ 分开问，每次一个任务

4. 不指定格式
❌ "给我数据"
✅ "用表格形式，包含日期、收入、支出、利润四列"

━━━━━━━━━━━━━━━━━━━━━━━━

📋 Prompt 速查表

| 场景 | 推荐 Prompt 开头 |
|---|---|
| 写代码 | "你是兵部尚书，请用【语言】实现【功能】，要求..." |
| 分析数据 | "你是户部尚书，请分析【数据】，重点关注..." |
| 写文案 | "你是礼部尚书，请为【产品】撰写【类型】，目标..." |
| 项目规划 | "你是吏部尚书，请为【项目】制定【计划】..." |
| 法务审查 | "你是刑部尚书，请审查【文档】，重点关注..." |
| 部署运维 | "你是工部尚书，请为【服务】设计【方案】..." |
| 学习问题 | "你是国子监祭酒，请讲解【知识点】，包括..." |
| 健康建议 | "你是太医院院使，请针对【症状】给出建议..." |

━━━━━━━━━━━━━━━━━━━━━━━━

📚 下一步学习

1. 自定义 Skill 开发 - 打造专属朝廷技能
2. 多模型路由优化 - 根据任务自动选择最合适的模型
3. 自动化工作流 - 把重复工作交给朝廷
4. API 集成 - 连接更多外部服务

━━━━━━━━━━━━━━━━━━━━━━━━

版本：进阶篇 v1.1（新增 cron + Discord）
字数：约 5500 字
适用：老手进阶/私域分发
更新日期：2026-02-22
作者：菠萝王朝·礼部
配合使用：《小红书教程 - 基础篇》

━━━━━━━━━━━━━━━━━━━━━━━━

🎊 恭喜完成进阶篇学习！

现在你的朝廷已经武装到牙齿，可以高效运转了！

有任何问题，欢迎在 Discord 找礼部交流～ 🎋
